# HTML转Docx转换器使用说明

## 功能概述

这个转换器可以将包含HTML内容的txt文件转换为带图片的docx文档。主要功能包括：

1. 识别txt文件中的图片描述标记
2. 根据描述智能生成技术架构图片
3. 将生成的图片插入到Word文档中
4. 支持批量转换多个文件

## 文件说明

### 主要程序文件

1. **Simple_HTML_to_Docx.py** - 简化版转换器（推荐使用）
   - 专门处理图片描述标记
   - 自动生成技术架构图片
   - 轻量级，依赖少

2. **HTML_to_Docx_Converter.py** - 完整版转换器
   - 支持完整的HTML标签处理
   - 使用html2image库转换HTML
   - 功能更全面但依赖较多

### 依赖文件

- **requirements_converter.txt** - 转换器所需的Python包

## 安装依赖

```bash
pip install -r requirements_converter.txt
```

或者单独安装：

```bash
pip install python-docx Pillow requests
```

## 使用方法

### 1. 准备输入文件

确保你的txt文件包含图片描述标记，格式如下：

```
这是文本内容。

（此处需[系统架构设计]的图片）

这是更多文本内容。

（此处需[数据流程图]的图片）
```

### 2. 运行转换器

```bash
python Simple_HTML_to_Docx.py
```

### 3. 查看结果

转换后的docx文件将保存在 `converted_docx` 目录中。

## 输入文件格式

### 支持的图片描述格式

- `（此处需[描述内容]的图片）`
- 描述内容应该简洁明了，描述需要生成的图片内容

### 示例

```
1. 项目概述

本项目旨在建设一个智能化的海洋监管平台。

（此处需[系统整体架构图]的图片）

2. 技术方案

采用微服务架构，确保系统的高可用性和可扩展性。

（此处需[微服务架构图]的图片）

系统包含数据采集、处理、存储和展示等多个模块。

（此处需[数据流程图]的图片）
```

## 输出结果

转换器会生成：

1. **Word文档** - 包含文本内容和生成的图片
2. **图片居中显示** - 图片宽度为14厘米
3. **技术架构图** - 根据描述自动生成的专业图片

## 图片生成说明

### 自动生成的图片特点

1. **技术架构风格** - 采用专业的技术架构图样式
2. **三层架构** - 包含数据层、服务层、应用层
3. **颜色搭配** - 使用专业的蓝色系配色
4. **文字清晰** - 支持中文显示

### 图片内容

- 标题：根据描述自动生成
- 说明：简要的技术说明
- 架构框：标准的三层架构展示

## 批量转换

转换器会自动处理 `generated_proposal` 目录中的所有txt文件，包括：

- 章节文件（如：章节_1_项目概述.txt）
- 最终标书文件（如：最终标书.txt）

## 错误处理

### 常见问题

1. **API调用失败**
   - 检查网络连接
   - 确认API Key是否正确

2. **字体显示问题**
   - 程序会自动使用默认字体
   - 不影响功能使用

3. **图片生成失败**
   - 会自动生成默认图片
   - 确保程序继续运行

## 自定义配置

### 修改图片尺寸

在代码中修改 `width_cm` 参数：

```python
self.add_image_to_docx(doc, image_data, width_cm=12.0)  # 改为12厘米
```

### 修改API设置

在 `__init__` 方法中修改API配置：

```python
self.api_key = "你的API Key"
```

## 性能优化

1. **图片缓存** - 相同描述的图片会被缓存
2. **批量处理** - 一次性处理多个文件
3. **错误恢复** - 单个文件失败不影响其他文件

## 注意事项

1. 确保txt文件使用UTF-8编码
2. 图片描述要简洁明确
3. 建议在转换前备份原始文件
4. 生成的图片为PNG格式，质量较高

## 技术支持

如果遇到问题，请检查：

1. Python版本（建议3.7+）
2. 依赖包是否正确安装
3. 输入文件格式是否正确
4. 网络连接是否正常 