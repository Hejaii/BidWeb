# ProposalLLM 优化版

## 系统概述

ProposalLLM是一个基于大模型的智能标书生成系统，能够根据需求对应表和产品文档自动生成专业的标书内容。

## 主要改进

### 1. 内容质量优化
- **更简洁**：应答内容控制在80字以内，产品介绍控制在300字以内
- **更专业**：语言更加正式，符合标书要求
- **更精准**：减少了重复和冗余内容

### 2. 图片描述优化
- **更简洁**：图片描述控制在30字以内
- **去重机制**：避免重复生成相似描述
- **缓存机制**：减少API调用次数

### 3. 格式改进
- **更专业**：去除了不必要的标点符号
- **更清晰**：标题生成更加简洁明了
- **更一致**：统一了输出格式

### 4. 性能优化
- **减少API调用**：通过缓存和去重机制减少不必要的API调用
- **提高效率**：优化了内容生成逻辑

## 安装配置

### 1. 环境要求
```bash
pip install -r requirements.txt
```

### 2. API配置
在 `config.py` 文件中配置API密钥：
```python
OPENAI_API_KEY = "你的OpenAI API Key"
QWEN_API_KEY = "你的通义千问 API Key"
```

### 3. 参数配置
在 `config.py` 文件中可以调整以下参数：
- `MAX_WIDTH_CM`: 图片最大宽度
- `MoreSection`: 是否启用新的标题生成策略
- `DDDAnswer`: 是否生成点对点应答
- `key_flag`: 是否包含重要性标记

## 使用步骤

### 1. 准备文档
- 将产品说明手册复制到 `Template.docx`
- 确保使用正确的样式（正文、标题1、标题2、标题3）

### 2. 提取文档
```bash
python3 Extract_Word.py
```
这将根据产品手册生成多个可重用的文档文件。

### 3. 填写需求对应表
在 `需求对应表.xlsx` 中填写：
- B列：需求类型（可选）
- C列：需求说明
- G列：对应的产品文档章节号（如果没有对应章节，填写X）

### 4. 生成标书
```bash
python3 Generate.py
```

## 输出结果

系统会生成：
1. **标书内容.docx**：完整的标书文档
2. **需求对应表.xlsx**：更新后的需求对应表，包含生成的应答和章节号

## 功能特点

### 1. 智能内容生成
- 根据需求自动生成专业的应答内容
- 支持产品文档内容的自动重写
- 生成简洁明了的标题

### 2. 图片处理
- 自动保留原文档中的图片
- 为缺少图片的内容生成专业的图片描述
- 支持图片尺寸自动调整

### 3. 格式保持
- 保持原文档的格式和样式
- 自动处理表格和列表
- 统一字体为宋体

### 4. 缓存机制
- 避免重复生成相同内容
- 减少API调用次数
- 提高生成效率

## 配置说明

### Prompt配置
在 `config.py` 中可以自定义各种Prompt：
- `answer`: 点对点应答生成
- `content`: 产品功能介绍生成
- `rewrite`: 内容重写
- `title`: 标题简化
- `image`: 图片描述生成

### 功能开关
- `MoreSection`: 启用新的标题生成策略
- `ReGenerateText`: 是否重写产品文档文字内容
- `DDDAnswer`: 是否生成点对点应答
- `key_flag`: 是否包含重要性标记

## 注意事项

1. **API限制**：注意API调用次数限制，建议合理设置缓存
2. **文档格式**：确保使用正确的Word样式，避免格式问题
3. **内容质量**：生成的内容需要人工审核和调整
4. **文件备份**：建议在运行前备份重要文件

## 技术支持

如有问题，请检查：
1. API密钥是否正确配置
2. 文档格式是否符合要求
3. 网络连接是否正常
4. 依赖包是否正确安装

## 版本历史

- v2.0: 优化内容质量，减少重复，提高效率
- v1.0: 基础功能实现 